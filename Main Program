/* 


     "mini sumo robotunun çalışan programının son hali"
     
*/


const int motor1_Forward = 6; // motor1 => sağ motor
const int motor1_Reverse = 5; 
const int motor2_Forward = 10; // motor2 => sol motor
const int motor2_Reverse = 9;

int mL = 0;
int mC = 0;
int mR = 0;

int rL = 0;
int rR = 0;

byte speed = 255;

void setup(){

  pinMode(5, OUTPUT); // sağ motor
  pinMode(6, OUTPUT);
  
  pinMode(9, OUTPUT); // sol motor
  pinMode(10, OUTPUT);
  
  pinMode(A0, INPUT); // QTR-1A - Reflectance Sensor
  pinMode(A1, INPUT);
  
  pinMode(A2, INPUT); // mz80 - IR Sensor
  pinMode(A3, INPUT);
  pinMode(A4, INPUT);

}

void loop(){

  rL = analogRead(A0); // zeminin rengini anlayacak olan sensörler
  rR = analogRead(A1);
  
  mC = analogRead(A2); // rakip robotu tespit edecek olan sensörler
  mL = analogRead(A3);
  mR = analogRead(A4);
  
  if(rL > 300 && rR > 300){  // eğer iki sensör de siyah rengi görürse rakip robotu ara
  
    if(mC < 200){  // merkezde bulunanan sensör rakip robotu algılarsa robot tam karşında demektir
    
      digitalWrite(motor1_Reverse, 0);
      digitalWrite(motor1_Forward, speed);
      digitalWrite(motor2_Forward, speed);    // rakibi sahadan atmak için rakibe doğru ilerle
      digitalWrite(motor2_Reverse, 0);
      delay(256);
    }
    
    else if(mL < 200){    // sol sensör rakibi algılarsa merkez sensör rakibi algılayana kadar sağ motoru çalıştır
    
      digitalWrite(motor1_Reverse, 0);
      digitalWrite(motor1_Forward, speed);
      digitalWrite(motor2_Forward, 0);    
      digitalWrite(motor2_Reverse, 0);
      delay(152);
    }
    
    else if(mR < 200){     // sağ sensör rakibi algılarsa merkez sensör rakibi algılayana kadar sol motoru çalıştır
    
      digitalWrite(motor2_Forward, speed);    
      digitalWrite(motor2_Reverse, 0);
      digitalWrite(motor1_Forward, 0);    
      digitalWrite(motor1_Reverse, 0);
      delay(152);
    
    }
    
    else{
    
      digitalWrite(motor1_Reverse, 0);    // hiçbir sensör rakibi algılamazsa rakibi bulmak için kendi etrafında dön
      digitalWrite(motor1_Forward, speed);
      digitalWrite(motor2_Forward, 0);    
      digitalWrite(motor2_Reverse, speed);
      delay(152);
    
    }
  }
  
  else{  // eğer sensörlerden biri ve ikisi beyaz rengi görürse sahaya geri dönmeye çalış
  
    digitalWrite(motor1_Reverse, speed);
    digitalWrite(motor1_Forward, 0);
    digitalWrite(motor2_Forward, 0);    
    digitalWrite(motor2_Reverse, speed);
    delay (256);
    
    digitalWrite(motor1_Reverse, 0);
    digitalWrite(motor1_Forward, 0);
    digitalWrite(motor2_Forward, 0);    
    digitalWrite(motor2_Reverse, 0);
    
    delay(15);
    
    digitalWrite(motor1_Reverse, 0);
    digitalWrite(motor1_Forward, speed);
    digitalWrite(motor2_Forward, 0);    
    digitalWrite(motor2_Reverse, speed);
    
    delay (152);
  
    
  
  }


}
